-----
2025.01.13
Test relaxing Filter by Taxon Parameters

mkdir /data/schwartzlab/Biancani/FilterByTaxaTest
cd /data/schwartzlab/Biancani/FilterByTaxaTest

# reduce minimum sequence completeness from 33% non N to 25% non N

nano seq_complete.sh
_____________________________
#!/bin/sh
#SBATCH --job-name="filter"
#SBATCH --time=30:00:00  # walltime limit (HH:MM:SS)
#SBATCH --nodes=1   # number of nodes
#SBATCH --ntasks-per-node=1   # processor core(s) per node - just use 1 
#SBATCH --mail-user="biancani@uri.edu" #CHANGE to your email
#SBATCH --mail-type=ALL

## UPDATE PATHS:
# path to SISRS loci (aligned contigs) folder:
LOCI=/data/schwartzlab/Biancani/PLACENTAL/SISRS_out/SISRS_Run/aligned_contigs
# path to folder containing filterByTaxa scripts:
SCRIPTS=/data/schwartzlab/Biancani/PlacentalPolytomy/01_FilterByTaxa
# path to taxon group table (csv):
TXNGROUPS=/data/schwartzlab/Biancani/PlacentalPolytomy/01_FilterByTaxa/groups.csv
# path to output folder for filtered loci (will be created by script if necessary):
OUTPUT=/data/schwartzlab/Biancani/FilterByTaxaTest/seqcomplete_25

## UPDATE parameters:
SEQCOMPLETE=0.25 # taxon sequence completeness, (e.g. 0.33 is 33% non N)
MINTAXA=18 # minimum number taxa to be present, e.g. 18
MINGROUPS=4 # minimum number of taxon groups to be present, e.g. 4

echo "Total number of unfiltered SISRS loci: (skipped counting)"
#ls -1U $LOCI | wc -l
cd $SLURM_SUBMIT_DIR
module purge
#for URI's Andromeda cluster
module load Biopython/1.78-foss-2020b 
mkdir -p $OUTPUT
python $SCRIPTS/filter_SISRS_output.py $TXNGROUPS $LOCI $OUTPUT $SEQCOMPLETE $MINTAXA $MINGROUPS
echo "Number of filtered SISRS loci (seqcomplete = 0.25):"
ls -1U $OUTPUT | wc -l
_____________________________
sbatch -q schwartzlab seq_complete.sh
Submitted batch job 354845

# reduce minimum number of taxa from 18 (49%) to 9 (25%)

nano min_taxa.sh
_____________________________
#!/bin/sh
#SBATCH --job-name="filter"
#SBATCH --time=30:00:00  # walltime limit (HH:MM:SS)
#SBATCH --nodes=1   # number of nodes
#SBATCH --ntasks-per-node=1   # processor core(s) per node - just use 1 
#SBATCH --mail-user="biancani@uri.edu" #CHANGE to your email
#SBATCH --mail-type=ALL

## UPDATE PATHS:
# path to SISRS loci (aligned contigs) folder:
LOCI=/data/schwartzlab/Biancani/PLACENTAL/SISRS_out/SISRS_Run/aligned_contigs
# path to folder containing filterByTaxa scripts:
SCRIPTS=/data/schwartzlab/Biancani/PlacentalPolytomy/01_FilterByTaxa
# path to taxon group table (csv):
TXNGROUPS=/data/schwartzlab/Biancani/PlacentalPolytomy/01_FilterByTaxa/groups.csv
# path to output folder for filtered loci (will be created by script if necessary):
OUTPUT=/data/schwartzlab/Biancani/FilterByTaxaTest/mintaxa_9

## UPDATE parameters:
SEQCOMPLETE=0.33 # taxon sequence completeness, (e.g. 0.33 is 33% non N)
MINTAXA=9 # minimum number taxa to be present, e.g. 18
MINGROUPS=4 # minimum number of taxon groups to be present, e.g. 4

echo "Total number of unfiltered SISRS loci: (skipped counting)"
#ls -1U $LOCI | wc -l
cd $SLURM_SUBMIT_DIR
module purge
#for URI's Andromeda cluster
module load Biopython/1.78-foss-2020b 
mkdir -p $OUTPUT
python $SCRIPTS/filter_SISRS_output.py $TXNGROUPS $LOCI $OUTPUT $SEQCOMPLETE $MINTAXA $MINGROUPS
echo "Number of filtered SISRS loci (mintaxa = 9):"
ls -1U $OUTPUT | wc -l
_____________________________
sbatch -q schwartzlab min_taxa.sh
Submitted batch job 354846

# reduce minimum number of taxon groups from 4 (100%) to 3 (75%)

nano min_groups.sh
_____________________________
#!/bin/sh
#SBATCH --job-name="filter"
#SBATCH --time=30:00:00  # walltime limit (HH:MM:SS)
#SBATCH --nodes=1   # number of nodes
#SBATCH --ntasks-per-node=1   # processor core(s) per node - just use 1 
#SBATCH --mail-user="biancani@uri.edu" #CHANGE to your email
#SBATCH --mail-type=ALL

## UPDATE PATHS:
# path to SISRS loci (aligned contigs) folder:
LOCI=/data/schwartzlab/Biancani/PLACENTAL/SISRS_out/SISRS_Run/aligned_contigs
# path to folder containing filterByTaxa scripts:
SCRIPTS=/data/schwartzlab/Biancani/PlacentalPolytomy/01_FilterByTaxa
# path to taxon group table (csv):
TXNGROUPS=/data/schwartzlab/Biancani/PlacentalPolytomy/01_FilterByTaxa/groups.csv
# path to output folder for filtered loci (will be created by script if necessary):
OUTPUT=/data/schwartzlab/Biancani/FilterByTaxaTest/mingroups_3

## UPDATE parameters:
SEQCOMPLETE=0.33 # taxon sequence completeness, (e.g. 0.33 is 33% non N)
MINTAXA=18 # minimum number taxa to be present, e.g. 18
MINGROUPS=3 # minimum number of taxon groups to be present, e.g. 4

echo "Total number of unfiltered SISRS loci: (skipped counting)"
#ls -1U $LOCI | wc -l
cd $SLURM_SUBMIT_DIR
module purge
#for URI's Andromeda cluster
module load Biopython/1.78-foss-2020b 
mkdir -p $OUTPUT
python $SCRIPTS/filter_SISRS_output.py $TXNGROUPS $LOCI $OUTPUT $SEQCOMPLETE $MINTAXA $MINGROUPS
echo "Number of filtered SISRS loci (mingroups = 3):"
ls -1U $OUTPUT | wc -l
_____________________________
sbatch -q schwartzlab min_groups.sh
Submitted batch job 354844

